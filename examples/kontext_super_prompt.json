{
  "id": "b12431b4-5c8d-4977-93fd-2cd904ea3e7d",
  "revision": 0,
  "last_node_id": 71,
  "last_link_id": 118,
  "nodes": [
    {
      "id": 32,
      "type": "PreviewImage",
      "pos": [
        -118.42778015136719,
        1285.1959228515625
      ],
      "size": [
        211.1578826904297,
        258.7719421386719
      ],
      "flags": {},
      "order": 10,
      "mode": 4,
      "inputs": [
        {
          "label": "images",
          "name": "images",
          "type": "IMAGE",
          "link": 45
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewImage",
        "widget_ue_connectable": {}
      },
      "widgets_values": []
    },
    {
      "id": 11,
      "type": "PreviewImage",
      "pos": [
        252.88357543945312,
        135.90113830566406
      ],
      "size": [
        308.890625,
        509.82257080078125
      ],
      "flags": {},
      "order": 6,
      "mode": 4,
      "inputs": [
        {
          "label": "images",
          "name": "images",
          "type": "IMAGE",
          "link": 12
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewImage",
        "widget_ue_connectable": {}
      },
      "widgets_values": []
    },
    {
      "id": 34,
      "type": "PreviewAny",
      "pos": [
        -129.64793395996094,
        404.0813903808594
      ],
      "size": [
        336.2765808105469,
        125.22488403320312
      ],
      "flags": {},
      "order": 8,
      "mode": 4,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 52
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 35,
      "type": "PreviewAny",
      "pos": [
        -133.9944305419922,
        592.2728271484375
      ],
      "size": [
        336.2765808105469,
        125.22488403320312
      ],
      "flags": {},
      "order": 9,
      "mode": 4,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 53
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 36,
      "type": "PreviewAny",
      "pos": [
        648.7251586914062,
        157.5330810546875
      ],
      "size": [
        358.8951110839844,
        219.46885681152344
      ],
      "flags": {},
      "order": 7,
      "mode": 4,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 54
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 10,
      "type": "LoadImage",
      "pos": [
        -472.82293701171875,
        135.90113830566406
      ],
      "size": [
        290.6379699707031,
        551.3299560546875
      ],
      "flags": {},
      "order": 0,
      "mode": 4,
      "inputs": [],
      "outputs": [
        {
          "label": "IMAGE",
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            11
          ]
        },
        {
          "label": "MASK",
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "LoadImage",
        "widget_ue_connectable": {}
      },
      "widgets_values": [
        "色阶示意图.jpg",
        "image"
      ]
    },
    {
      "id": 12,
      "type": "VisualPromptEditor",
      "pos": [
        -140.18496704101562,
        135.90113830566406
      ],
      "size": [
        351.06854248046875,
        220
      ],
      "flags": {},
      "order": 3,
      "mode": 4,
      "inputs": [
        {
          "label": "image",
          "name": "image",
          "type": "IMAGE",
          "link": 11
        }
      ],
      "outputs": [
        {
          "label": "processed_image",
          "name": "processed_image",
          "type": "IMAGE",
          "links": [
            12
          ]
        },
        {
          "label": "structured_prompt",
          "name": "structured_prompt",
          "type": "STRING",
          "links": [
            54
          ]
        },
        {
          "label": "annotation_data",
          "name": "annotation_data",
          "type": "STRING",
          "links": [
            52
          ]
        },
        {
          "label": "model_instruction",
          "name": "model_instruction",
          "type": "STRING",
          "links": [
            53
          ]
        }
      ],
      "properties": {
        "aux_id": "aiaiaikkk/Kontext-Visual-Prompt-Window",
        "Node name for S&R": "VisualPromptEditor",
        "ver": "332100f6a29b84d947873210d82e08381a01acdb",
        "widget_ue_connectable": {}
      },
      "widgets_values": [
        "{\"positive_prompt\":\"\",\"negative_prompt\":\"\",\"selected_annotations\":[],\"global_operation_type\":\"global_color_grade\",\"global_description\":\"\",\"template_category\":\"global\",\"constraint_prompts\":[],\"decorative_prompts\":[],\"include_annotation_numbers\":false,\"annotations\":[],\"quality_analysis\":{\"score\":30,\"word_count\":1,\"char_count\":0,\"professional_terms\":0,\"descriptive_terms\":0,\"constraint_terms\":0,\"suggestions\":[\"Prompt needs improvement, add more specific details\",\"Prompt too short, add more details\"],\"grade\":\"D\"},\"editing_mode\":\"hybrid\",\"timestamp\":\"2025-07-14T12:30:46.494Z\"}",
        "",
        "global_color_grade",
        "Visual Editor Ready"
      ],
      "color": "#673AB7",
      "bgcolor": "#512DA8"
    },
    {
      "id": 17,
      "type": "LoadImage",
      "pos": [
        -467.91558837890625,
        1005.3504638671875
      ],
      "size": [
        290.6379699707031,
        551.3299560546875
      ],
      "flags": {},
      "order": 1,
      "mode": 4,
      "inputs": [],
      "outputs": [
        {
          "label": "IMAGE",
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            19
          ]
        },
        {
          "label": "MASK",
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "LoadImage",
        "widget_ue_connectable": {}
      },
      "widgets_values": [
        "example.png",
        "image"
      ]
    },
    {
      "id": 52,
      "type": "PreviewAny",
      "pos": [
        647.678955078125,
        1731.2271728515625
      ],
      "size": [
        419.7159423828125,
        152.90304565429688
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 72
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 53,
      "type": "PreviewAny",
      "pos": [
        648.1552734375,
        2023.482421875
      ],
      "size": [
        419.7159423828125,
        152.90304565429688
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 73
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 38,
      "type": "PreviewAny",
      "pos": [
        642.7372436523438,
        1334.23388671875
      ],
      "size": [
        413.7573547363281,
        172.03590393066406
      ],
      "flags": {},
      "order": 14,
      "mode": 4,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 118
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 18,
      "type": "VisualPromptEditor",
      "pos": [
        -135.277587890625,
        1005.3504638671875
      ],
      "size": [
        351.06854248046875,
        220
      ],
      "flags": {},
      "order": 4,
      "mode": 4,
      "inputs": [
        {
          "label": "image",
          "name": "image",
          "type": "IMAGE",
          "link": 19
        }
      ],
      "outputs": [
        {
          "label": "processed_image",
          "name": "processed_image",
          "type": "IMAGE",
          "links": [
            45,
            115
          ]
        },
        {
          "label": "structured_prompt",
          "name": "structured_prompt",
          "type": "STRING",
          "links": [
            116
          ]
        },
        {
          "label": "annotation_data",
          "name": "annotation_data",
          "type": "STRING",
          "links": []
        },
        {
          "label": "model_instruction",
          "name": "model_instruction",
          "type": "STRING",
          "links": null
        }
      ],
      "properties": {
        "aux_id": "aiaiaikkk/Kontext-Visual-Prompt-Window",
        "Node name for S&R": "VisualPromptEditor",
        "ver": "332100f6a29b84d947873210d82e08381a01acdb",
        "widget_ue_connectable": {}
      },
      "widgets_values": [
        "{\"positive_prompt\":\"\",\"negative_prompt\":\"\",\"selected_annotations\":[{\"id\":\"annotation_1752568776337_01229esjp\",\"operationType\":\"add_object\",\"description\":\"\",\"type\":\"rectangle\",\"color\":\"#ff0000\",\"number\":0,\"constraintPrompts\":[],\"decorativePrompts\":[]}],\"global_operation_type\":\"global_color_grade\",\"global_description\":\"\",\"template_category\":\"global\",\"constraint_prompts\":[],\"decorative_prompts\":[],\"include_annotation_numbers\":false,\"annotations\":[{\"id\":\"annotation_1752568776337_01229esjp\",\"type\":\"rectangle\",\"color\":\"#ff0000\",\"fillMode\":\"filled\",\"opacity\":100,\"number\":0,\"geometry\":{\"type\":\"rectangle\",\"coordinates\":[335.3999938964844,196.19067129817034,472.3999938964844,286.71916870749675]},\"start\":{\"x\":335.3999938964844,\"y\":196.19067129817034},\"end\":{\"x\":472.3999938964844,\"y\":286.71916870749675}}],\"quality_analysis\":{\"score\":30,\"word_count\":1,\"char_count\":0,\"professional_terms\":0,\"descriptive_terms\":0,\"constraint_terms\":0,\"suggestions\":[\"Prompt needs improvement, add more specific details\",\"Prompt too short, add more details\"],\"grade\":\"D\"},\"editing_mode\":\"hybrid\",\"timestamp\":\"2025-07-15T08:39:38.844Z\"}",
        "",
        "global_color_grade",
        "Visual Editor Ready"
      ],
      "color": "#673AB7",
      "bgcolor": "#512DA8"
    },
    {
      "id": 65,
      "type": "OllamaFluxKontextEnhancerV2",
      "pos": [
        261.4505920410156,
        1002.6213989257812
      ],
      "size": [
        307.6678466796875,
        471.3163757324219
      ],
      "flags": {},
      "order": 11,
      "mode": 4,
      "inputs": [
        {
          "name": "annotation_data",
          "type": "STRING",
          "link": 116
        },
        {
          "name": "image",
          "shape": 7,
          "type": "IMAGE",
          "link": 115
        }
      ],
      "outputs": [
        {
          "name": "flux_edit_instructions",
          "type": "STRING",
          "links": [
            117
          ]
        },
        {
          "name": "system_prompt",
          "type": "STRING",
          "links": [
            118
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "OllamaFluxKontextEnhancerV2"
      },
      "widgets_values": [
        "qwen3:0.6b",
        "qwen3:0.6b",
        0.7,
        false,
        3755738771,
        "increment",
        "",
        "none",
        "refresh",
        "refresh",
        "refresh",
        "refresh",
        "refresh"
      ],
      "color": "#673AB7",
      "bgcolor": "#512DA8",
      "model_selection": "qwen3:0.6b"
    },
    {
      "id": 37,
      "type": "PreviewAny",
      "pos": [
        642.1524658203125,
        1006.9070434570312
      ],
      "size": [
        385.24310302734375,
        280.13470458984375
      ],
      "flags": {},
      "order": 13,
      "mode": 4,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 117
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 24,
      "type": "LoadImage",
      "pos": [
        -462.89434814453125,
        1719.6444091796875
      ],
      "size": [
        290.6379699707031,
        551.3299560546875
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "label": "IMAGE",
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            27
          ]
        },
        {
          "label": "MASK",
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "LoadImage",
        "widget_ue_connectable": {}
      },
      "widgets_values": [
        "example.png",
        "image"
      ]
    },
    {
      "id": 51,
      "type": "APIFluxKontextEnhancer",
      "pos": [
        258.5035705566406,
        1723.764892578125
      ],
      "size": [
        302.5849609375,
        528.4076538085938
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "annotation_data",
          "type": "STRING",
          "link": 75
        },
        {
          "name": "image",
          "shape": 7,
          "type": "IMAGE",
          "link": 74
        }
      ],
      "outputs": [
        {
          "name": "flux_edit_instructions",
          "type": "STRING",
          "links": [
            72
          ]
        },
        {
          "name": "system_prompt",
          "type": "STRING",
          "links": [
            73
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "APIFluxKontextEnhancer"
      },
      "widgets_values": [
        "siliconflow",
        "sk-nudgiksbzjuobuthzfbzwbucznpretxwjdhtegoubblfdtac",
        "deepseek-ai/DeepSeek-V3",
        "",
        "让照片调整的看起来更通透",
        "auto_detect",
        "efficient_concise",
        "none",
        155397416299291,
        "randomize",
        "",
        "none"
      ],
      "color": "#673AB7",
      "bgcolor": "#512DA8"
    },
    {
      "id": 27,
      "type": "VisualPromptEditor",
      "pos": [
        -130.45835876464844,
        1720.154052734375
      ],
      "size": [
        351.06854248046875,
        220
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {
          "label": "image",
          "name": "image",
          "type": "IMAGE",
          "link": 27
        }
      ],
      "outputs": [
        {
          "label": "processed_image",
          "name": "processed_image",
          "type": "IMAGE",
          "links": [
            74
          ]
        },
        {
          "label": "structured_prompt",
          "name": "structured_prompt",
          "type": "STRING",
          "links": []
        },
        {
          "label": "annotation_data",
          "name": "annotation_data",
          "type": "STRING",
          "links": [
            75
          ]
        },
        {
          "label": "model_instruction",
          "name": "model_instruction",
          "type": "STRING",
          "links": null
        }
      ],
      "properties": {
        "aux_id": "aiaiaikkk/Kontext-Visual-Prompt-Window",
        "Node name for S&R": "VisualPromptEditor",
        "ver": "332100f6a29b84d947873210d82e08381a01acdb",
        "widget_ue_connectable": {}
      },
      "widgets_values": [
        "{\"positive_prompt\":\"\",\"negative_prompt\":\"\",\"selected_annotations\":[],\"global_operation_type\":\"global_color_grade\",\"global_description\":\"\",\"template_category\":\"global\",\"constraint_prompts\":[],\"decorative_prompts\":[],\"include_annotation_numbers\":false,\"annotations\":[],\"quality_analysis\":{\"score\":30,\"word_count\":1,\"char_count\":0,\"professional_terms\":0,\"descriptive_terms\":0,\"constraint_terms\":0,\"suggestions\":[\"Prompt needs improvement, add more specific details\",\"Prompt too short, add more details\"],\"grade\":\"D\"},\"editing_mode\":\"hybrid\",\"timestamp\":\"2025-07-15T08:42:17.851Z\"}",
        "",
        "global_color_grade",
        "Visual Editor Ready"
      ],
      "color": "#673AB7",
      "bgcolor": "#512DA8"
    }
  ],
  "links": [
    [
      11,
      10,
      0,
      12,
      0,
      "IMAGE"
    ],
    [
      12,
      12,
      0,
      11,
      0,
      "IMAGE"
    ],
    [
      19,
      17,
      0,
      18,
      0,
      "IMAGE"
    ],
    [
      27,
      24,
      0,
      27,
      0,
      "IMAGE"
    ],
    [
      45,
      18,
      0,
      32,
      0,
      "IMAGE"
    ],
    [
      52,
      12,
      2,
      34,
      0,
      "*"
    ],
    [
      53,
      12,
      3,
      35,
      0,
      "*"
    ],
    [
      54,
      12,
      1,
      36,
      0,
      "*"
    ],
    [
      72,
      51,
      0,
      52,
      0,
      "*"
    ],
    [
      73,
      51,
      1,
      53,
      0,
      "*"
    ],
    [
      74,
      27,
      0,
      51,
      1,
      "IMAGE"
    ],
    [
      75,
      27,
      2,
      51,
      0,
      "STRING"
    ],
    [
      115,
      18,
      0,
      65,
      1,
      "IMAGE"
    ],
    [
      116,
      18,
      1,
      65,
      0,
      "STRING"
    ],
    [
      117,
      65,
      0,
      37,
      0,
      "*"
    ],
    [
      118,
      65,
      1,
      38,
      0,
      "*"
    ]
  ],
  "groups": [
    {
      "id": 1,
      "title": "系统预设",
      "bounding": [
        -492.82293701171875,
        51.90113830566406,
        1582.69775390625,
        759.0355224609375
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 2,
      "title": "本地ollama调用",
      "bounding": [
        -487.91558837890625,
        921.3504638671875,
        1571.9727783203125,
        655.3299560546875
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 3,
      "title": "API远程调用",
      "bounding": [
        -482.89434814453125,
        1635.6444091796875,
        1571.9727783203125,
        655.3299560546875
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.2540132685242044,
      "offset": [
        2727.4573359096735,
        103.0785560902481
      ]
    },
    "frontendVersion": "1.23.4",
    "ue_links": [],
    "links_added_by_ue": []
  },
  "version": 0.4
}